<div class="bg-card text-card-foreground p-6 rounded-lg shadow-md">
  <h2 class="text-2xl font-semibold text-foreground mb-5">Who to Follow</h2>
  <% if recommended_users.any? %>
    <div class="flex flex-col gap-4">
      <% recommended_users.each do |user| %>
        <div class="flex items-center gap-3 pb-4 border-b border-border last:border-b-0 last:pb-0">
          <%= image_tag user.avatar, alt: user.username, class: "h-12 w-12 rounded-full object-cover flex-shrink-0 min-h-[48px] bg-muted", loading: "lazy" %>
          <div class="flex-grow">
            <%= link_to user.username, user_path(user), class: "font-semibold text-primary hover:underline text-base block" %>
            <small class="text-sm text-muted-foreground block"><%= user.name %></small>
          </div>
          <div class="flex-shrink-0">
            <% friendship_status = current_user.friendship_status_with(user) %>
            <% if friendship_status == 'not_friends' %>
              <%= button_to '<i class="fa-solid fa-user-plus mr-1"></i> Add Friend'.html_safe, friendships_path(friend_id: user.id), method: :post, class: "inline-flex items-center justify-center whitespace-nowrap rounded-md text-xs font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-8 px-3 py-1" %>
            <% elsif friendship_status == 'pending_outgoing' %>
              <span class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-xs font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-secondary text-secondary-foreground h-8 px-3 py-1"><i class="fa-solid fa-hourglass-half mr-1"></i> Pending</span>
            <% elsif friendship_status == 'pending_incoming' %>
              <%= button_to '<i class="fa-solid fa-check mr-1"></i> Accept'.html_safe, friendship_path(current_user.inverse_friendships.find_by(user: user)), method: :patch, class: "inline-flex items-center justify-center whitespace-nowrap rounded-md text-xs font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-8 px-3 py-1" %>
            <% elsif friendship_status == 'friends' %>
              <span class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-xs font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-secondary text-secondary-foreground h-8 px-3 py-1"><i class="fa-solid fa-user-group mr-1"></i> Friends</span>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <p class="text-center text-muted-foreground text-base">No new users to recommend at the moment.</p>
  <% end %>
</div>