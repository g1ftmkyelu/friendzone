<div class="bg-card text-card-foreground rounded-lg shadow-md p-6">
  <div class="flex items-center mb-4">
    <%= image_tag post.user.avatar, alt: post.user.username, class: "h-12 w-12 rounded-full object-cover mr-3 min-h-[48px] bg-muted", loading: "lazy" %>
    <div>
      <%= link_to post.user.username, user_path(post.user), class: "font-semibold text-primary hover:underline text-base" %>
      <br>
      <small class="text-xs text-muted-foreground"><%= time_ago_in_words(post.created_at) %> ago</small>
    </div>
  </div>

  <div class="mb-6">
    <% if post.content.present? %>
      <p class="text-base text-foreground leading-relaxed mb-4"><%= post.content %></p>
    <% end %>
    <% if post.image_url.present? %>
      <%= image_tag post.image_url, alt: "Post image", class: "max-w-full h-auto rounded-lg block mt-4 aspect-video bg-muted", loading: "lazy" %>
    <% end %>
  </div>

  <div class="flex flex-wrap justify-around pt-4 border-t border-border gap-2">
    <% if logged_in? %>
      <% if post.likes.exists?(user: current_user) %>
        <%= button_to '<i class="fa-solid fa-heart mr-2"></i> Unlike ('.html_safe + post.likes.count.to_s + ')', post_like_path(post, post.likes.find_by(user: current_user)), method: :delete, class: "inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary/10 text-primary hover:bg-primary/20 h-9 px-3 py-1" %>
      <% else %>
        <%= button_to '<i class="fa-solid fa-heart mr-2"></i> Like ('.html_safe + post.likes.count.to_s + ')', post_likes_path(post), method: :post, class: "inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 text-muted-foreground hover:bg-muted h-9 px-3 py-1" %>
      <% end %>
    <% else %>
      <span class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium text-muted-foreground h-9 px-3 py-1"><i class="fa-solid fa-heart mr-2"></i> Likes (<%= post.likes.count %>)</span>
    <% end %>
    <%= link_to post_path(post), class: "inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 text-muted-foreground hover:bg-muted h-9 px-3 py-1" do %>
      <i class="fa-solid fa-comment mr-2"></i> Comments (<%= post.comments.count %>)
    <% end %>
    <% if logged_in? && post.user == current_user %>
      <%= link_to edit_post_path(post), class: "inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-secondary text-secondary-foreground hover:bg-secondary/80 h-9 px-3 py-1" do %>
        <i class="fa-solid fa-pen-to-square mr-2"></i> Edit
      <% end %>
      <%= button_to '<i class="fa-solid fa-trash mr-2"></i> Delete'.html_safe, post_path(post), method: :delete, data: { confirm: "Are you sure you want to delete this post?" }, class: "inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-destructive text-destructive-foreground hover:bg-destructive/90 h-9 px-3 py-1" %>
    <% end %>
  </div>
</div>